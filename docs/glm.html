<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 Modelos de Regresión Avanzados | Modelos de Regresión: Una aproximación práctica con R</title>
  <meta name="description" content="Este libro recopila mi años de experiencia en el aprendizaje de R (R Core Team 2019), y está escrito como una guía para aquellos que recién comienzan." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 Modelos de Regresión Avanzados | Modelos de Regresión: Una aproximación práctica con R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este libro recopila mi años de experiencia en el aprendizaje de R (R Core Team 2019), y está escrito como una guía para aquellos que recién comienzan." />
  <meta name="github-repo" content="https://github.com/jivelez/book-adii" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 Modelos de Regresión Avanzados | Modelos de Regresión: Una aproximación práctica con R" />
  
  <meta name="twitter:description" content="Este libro recopila mi años de experiencia en el aprendizaje de R (R Core Team 2019), y está escrito como una guía para aquellos que recién comienzan." />
  

<meta name="author" content="Jorge I. Vélez" />


<meta name="date" content="2021-09-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rlm.html"/>
<link rel="next" href="series.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos de Regresión con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dedicatoria"><i class="fa fa-check"></i>Dedicatoria</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-el-autor"><i class="fa fa-check"></i>Sobre el autor</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#analítica-de-datos"><i class="fa fa-check"></i><b>1.1</b> Analítica de Datos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#conceptos-básicos"><i class="fa fa-check"></i><b>1.1.1</b> Conceptos básicos</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#gráficos-básicos"><i class="fa fa-check"></i><b>1.1.2</b> Gráficos básicos</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#tópicos-avanzados"><i class="fa fa-check"></i><b>1.1.3</b> Tópicos avanzados</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.2</b> <code>R</code></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#por-qué-r"><i class="fa fa-check"></i><b>1.2.1</b> Por qué <code>R</code>?</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#cran"><i class="fa fa-check"></i><b>1.2.2</b> <code>CRAN</code></a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#descarga-e-instalación"><i class="fa fa-check"></i><b>1.2.3</b> Descarga e instalación</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#paquetes"><i class="fa fa-check"></i><b>1.2.4</b> Paquetes</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#operadores-básicos"><i class="fa fa-check"></i><b>1.2.5</b> Operadores básicos</a></li>
<li class="chapter" data-level="1.2.6" data-path="intro.html"><a href="intro.html#creación-de-funciones"><i class="fa fa-check"></i><b>1.2.6</b> Creación de funciones</a></li>
<li class="chapter" data-level="1.2.7" data-path="intro.html"><a href="intro.html#obteniendo-ayuda"><i class="fa fa-check"></i><b>1.2.7</b> Obteniendo ayuda</a></li>
<li class="chapter" data-level="1.2.8" data-path="intro.html"><a href="intro.html#lectura-de-datos"><i class="fa fa-check"></i><b>1.2.8</b> Lectura de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rls.html"><a href="rls.html"><i class="fa fa-check"></i><b>2</b> Regresión Lineal Simple</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rls.html"><a href="rls.html#formulación-básica-del-modelo-de-rls"><i class="fa fa-check"></i><b>2.1</b> Formulación básica del modelo de RLS</a></li>
<li class="chapter" data-level="2.2" data-path="rls.html"><a href="rls.html#minimos"><i class="fa fa-check"></i><b>2.2</b> Estimación</a></li>
<li class="chapter" data-level="2.3" data-path="rls.html"><a href="rls.html#tabla-anova-y-medidas-de-desempeño"><i class="fa fa-check"></i><b>2.3</b> Tabla ANOVA y medidas de desempeño</a>
<ul>
<li><a href="rls.html#estimación-de-sigma2">Estimación de <span class="math inline">\(\sigma^2\)</span></a></li>
<li><a href="rls.html#inferencia-para-sigma2">Inferencia para <span class="math inline">\(\sigma^2\)</span></a></li>
<li><a href="rls.html#coeficiente-de-determinación-r2">Coeficiente de determinación <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#validación-del-modelo-de-rls"><i class="fa fa-check"></i>Validación del modelo de RLS</a></li>
<li><a href="rls.html#inferencia-para-beta_0-y-beta_1">Inferencia para <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rls.html"><a href="rls.html#residuales"><i class="fa fa-check"></i><b>2.4</b> Análisis de Residuales</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#validación-de-supuestos"><i class="fa fa-check"></i>Validación de Supuestos</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rls.html"><a href="rls.html#predicción"><i class="fa fa-check"></i><b>2.5</b> Predicción</a>
<ul>
<li><a href="rls.html#intervalo-de-confianza-para-eyxx_0">Intervalo de confianza para <span class="math inline">\(E[Y|X=x_0]\)</span></a></li>
<li><a href="rls.html#intervalo-de-predicción-para-eyxx_0">Intervalo de predicción para <span class="math inline">\(E[Y|X=x_0]\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rlm.html"><a href="rlm.html"><i class="fa fa-check"></i><b>3</b> Regresión Lineal Múltiple</a>
<ul>
<li class="chapter" data-level="3.1" data-path="rlm.html"><a href="rlm.html#formulación-básica-del-modelo-de-rlm"><i class="fa fa-check"></i><b>3.1</b> Formulación básica del modelo de RLM</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="rlm.html"><a href="rlm.html#estimacion"><i class="fa fa-check"></i><b>3.1.1</b> Estimación</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="rlm.html"><a href="rlm.html#propiedades-de-los-estimadores-de-mathbfbeta"><i class="fa fa-check"></i><b>3.2</b> Propiedades de los estimadores de <span class="math inline">\({\mathbf{\beta}}\)</span></a></li>
<li class="chapter" data-level="3.3" data-path="rlm.html"><a href="rlm.html#estimación-de-sigma2-1"><i class="fa fa-check"></i><b>3.3</b> Estimación de <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="3.4" data-path="rlm.html"><a href="rlm.html#inferencia-para-mathbfbeta"><i class="fa fa-check"></i><b>3.4</b> Inferencia para <span class="math inline">\(\mathbf{\beta}\)</span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="rlm.html"><a href="rlm.html#prueba-de-significancia-global"><i class="fa fa-check"></i><b>3.4.1</b> Prueba de significancia global</a></li>
<li class="chapter" data-level="3.4.2" data-path="rlm.html"><a href="rlm.html#prueba-de-significancia-marginal"><i class="fa fa-check"></i><b>3.4.2</b> Prueba de significancia marginal</a></li>
<li class="chapter" data-level="3.4.3" data-path="rlm.html"><a href="rlm.html#intervalos-de-confianza-para-beta_j"><i class="fa fa-check"></i><b>3.4.3</b> Intervalos de confianza para <span class="math inline">\(\beta_j\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="rlm.html"><a href="rlm.html#inferencia-para-emathbfymathbfx_0"><i class="fa fa-check"></i><b>3.5</b> Inferencia para <span class="math inline">\(E[\mathbf{Y}|\mathbf{x}_0]\)</span></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="rlm.html"><a href="rlm.html#intervalos-de-confianza-para-emathbfymathbfx_0"><i class="fa fa-check"></i><b>3.5.1</b> Intervalos de confianza para <span class="math inline">\(E[\mathbf{Y}|\mathbf{x}_0]\)</span></a></li>
<li class="chapter" data-level="3.5.2" data-path="rlm.html"><a href="rlm.html#intervalos-de-predicción-para-emathbfymathbfx_0"><i class="fa fa-check"></i><b>3.5.2</b> Intervalos de predicción para <span class="math inline">\(E[\mathbf{Y}|\mathbf{x}_0]\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="rlm.html"><a href="rlm.html#análisis-de-residuales"><i class="fa fa-check"></i><b>3.6</b> Análisis de Residuales</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="rlm.html"><a href="rlm.html#validación-de-supuestos-1"><i class="fa fa-check"></i><b>3.6.1</b> Validación de supuestos</a></li>
<li class="chapter" data-level="3.6.2" data-path="rlm.html"><a href="rlm.html#identificación-de-outliers"><i class="fa fa-check"></i><b>3.6.2</b> Identificación de <em>outliers</em></a></li>
<li class="chapter" data-level="3.6.3" data-path="rlm.html"><a href="rlm.html#identificación-de-observaciones-influenciales"><i class="fa fa-check"></i><b>3.6.3</b> Identificación de observaciones influenciales</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="rlm.html"><a href="rlm.html#análisis-de-multicolinealidad"><i class="fa fa-check"></i><b>3.7</b> Análisis de Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="rlm.html"><a href="rlm.html#cómo-detectarla"><i class="fa fa-check"></i><b>3.7.1</b> Cómo detectarla?</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="rlm.html"><a href="rlm.html#selección-de-modelos"><i class="fa fa-check"></i><b>3.8</b> Selección de Modelos</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="rlm.html"><a href="rlm.html#método-de-todas-las-regresiones-posibles"><i class="fa fa-check"></i><b>3.8.1</b> Método de Todas las Regresiones Posibles</a></li>
<li class="chapter" data-level="3.8.2" data-path="rlm.html"><a href="rlm.html#selección-secuencial"><i class="fa fa-check"></i><b>3.8.2</b> Selección secuencial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>4</b> Modelos de Regresión Avanzados</a>
<ul>
<li class="chapter" data-level="4.1" data-path="glm.html"><a href="glm.html#regresión-no-lineal"><i class="fa fa-check"></i><b>4.1</b> Regresión No Lineal</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="glm.html"><a href="glm.html#ejercicios"><i class="fa fa-check"></i><b>4.1.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="glm.html"><a href="glm.html#regresión-logística"><i class="fa fa-check"></i><b>4.2</b> Regresión Logística</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="glm.html"><a href="glm.html#ejercicios-1"><i class="fa fa-check"></i><b>4.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="glm.html"><a href="glm.html#regresión-poisson"><i class="fa fa-check"></i><b>4.3</b> Regresión Poisson</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="glm.html"><a href="glm.html#introducción"><i class="fa fa-check"></i><b>4.3.1</b> Introducción</a></li>
<li class="chapter" data-level="4.3.2" data-path="glm.html"><a href="glm.html#por-qué"><i class="fa fa-check"></i><b>4.3.2</b> Por qué?</a></li>
<li class="chapter" data-level="4.3.3" data-path="glm.html"><a href="glm.html#ejemplo"><i class="fa fa-check"></i><b>4.3.3</b> Ejemplo</a></li>
<li class="chapter" data-level="4.3.4" data-path="glm.html"><a href="glm.html#modelo-ajustado"><i class="fa fa-check"></i><b>4.3.4</b> Modelo ajustado</a></li>
<li class="chapter" data-level="4.3.5" data-path="glm.html"><a href="glm.html#cálculo-e-inferencia-para-hatlambda"><i class="fa fa-check"></i><b>4.3.5</b> Cálculo e inferencia para <span class="math inline">\(\hat{\lambda}\)</span></a></li>
<li class="chapter" data-level="4.3.6" data-path="glm.html"><a href="glm.html#estimación-del-número-de-errores"><i class="fa fa-check"></i><b>4.3.6</b> Estimación del número de errores</a></li>
<li class="chapter" data-level="4.3.7" data-path="glm.html"><a href="glm.html#cálculo-de-probabilidades"><i class="fa fa-check"></i><b>4.3.7</b> Cálculo de probabilidades</a></li>
<li class="chapter" data-level="4.3.8" data-path="glm.html"><a href="glm.html#variaciones"><i class="fa fa-check"></i><b>4.3.8</b> Variaciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="series.html"><a href="series.html"><i class="fa fa-check"></i><b>5</b> Introducción a Series de Tiempo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="series.html"><a href="series.html#qué-es-una-serie-de-tiempo"><i class="fa fa-check"></i><b>5.1</b> Qué es una Serie de Tiempo?</a></li>
<li class="chapter" data-level="5.2" data-path="series.html"><a href="series.html#definiciones-básicas"><i class="fa fa-check"></i><b>5.2</b> Definiciones básicas</a></li>
<li class="chapter" data-level="5.3" data-path="series.html"><a href="series.html#por-qué-y-para-qué"><i class="fa fa-check"></i><b>5.3</b> Por qué y para qué?</a></li>
<li class="chapter" data-level="5.4" data-path="series.html"><a href="series.html#modelos-básicos"><i class="fa fa-check"></i><b>5.4</b> Modelos básicos</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="series.html"><a href="series.html#método-de-descomposición"><i class="fa fa-check"></i><b>5.4.1</b> Método de Descomposición</a></li>
<li class="chapter" data-level="5.4.2" data-path="series.html"><a href="series.html#métodos-de-suavizamiento"><i class="fa fa-check"></i><b>5.4.2</b> Métodos de Suavizamiento</a></li>
<li class="chapter" data-level="5.4.3" data-path="series.html"><a href="series.html#metodología-box-jenkins"><i class="fa fa-check"></i><b>5.4.3</b> Metodología Box-Jenkins</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="series.html"><a href="series.html#validación-de-supuestos-2"><i class="fa fa-check"></i><b>5.5</b> Validación de supuestos</a></li>
<li class="chapter" data-level="5.6" data-path="series.html"><a href="series.html#pronósticos"><i class="fa fa-check"></i><b>5.6</b> Pronósticos</a></li>
<li class="chapter" data-level="5.7" data-path="series.html"><a href="series.html#ejercicios-2"><i class="fa fa-check"></i><b>5.7</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="enp.html"><a href="enp.html"><i class="fa fa-check"></i><b>6</b> Estadística No Paramétrica</a>
<ul>
<li class="chapter" data-level="6.1" data-path="enp.html"><a href="enp.html#por-qué-y-para-qué-1"><i class="fa fa-check"></i><b>6.1</b> Por qué y para qué?</a></li>
<li class="chapter" data-level="6.2" data-path="enp.html"><a href="enp.html#modelos-básicos-1"><i class="fa fa-check"></i><b>6.2</b> Modelos básicos</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="enp.html"><a href="enp.html#prueba-de-signos"><i class="fa fa-check"></i><b>6.2.1</b> Prueba de signos</a></li>
<li class="chapter" data-level="6.2.2" data-path="enp.html"><a href="enp.html#prueba-de-rangos-con-signos"><i class="fa fa-check"></i><b>6.2.2</b> Prueba de Rangos con Signos</a></li>
<li class="chapter" data-level="6.2.3" data-path="enp.html"><a href="enp.html#prueba-de-mann-whitney-wilcoxon"><i class="fa fa-check"></i><b>6.2.3</b> Prueba de Mann-Whitney-Wilcoxon</a></li>
<li class="chapter" data-level="6.2.4" data-path="enp.html"><a href="enp.html#prueba-de-kruskal-wallis"><i class="fa fa-check"></i><b>6.2.4</b> Prueba de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="enp.html"><a href="enp.html#ejercicios-3"><i class="fa fa-check"></i><b>6.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="palabras-finales.html"><a href="palabras-finales.html"><i class="fa fa-check"></i><b>7</b> Palabras Finales</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/jivelez/book-adii" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos de Regresión: Una aproximación práctica con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="glm" class="section level1" number="4">
<h1><span class="header-section-number">Capítulo 4</span> Modelos de Regresión Avanzados</h1>
<p>Here is a review of existing methods.</p>
<div id="regresión-no-lineal" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Regresión No Lineal</h2>
<div id="ejercicios" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ol>
</div>
</div>
<div id="regresión-logística" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Regresión Logística</h2>
<div id="ejercicios-1" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ol>
</div>
</div>
<div id="regresión-poisson" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Regresión Poisson</h2>
<div id="introducción" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Introducción</h3>
<p>La Regresión Poisson es útil cuando se tiene una variable aleatoria respuesta <span class="math inline">\(Y\)</span> que representa conteos por unidad de distancia, área, volúmen o tiempo, y es de interés predecir el <strong>número esperado</strong> de dichos conteos a partir de un conjunto de factores controlables independientes <span class="math inline">\(X_1, X_2, \ldots, X_k\)</span>.</p>
<p>La Regresión Poisson hace parte del Modelo Lineal Generalizado. Puesto que <span class="math inline">\(Y\)</span> representa conteos <em>independientes</em>, es natural pensar que la distribución Poisson sea un plausible modelo para describir el proceso que genera dichos conteos. Por lo tanto,</p>
<p><span class="math display">\[
Y \sim \text{Poisson}(\lambda), \quad \lambda &gt; 0,
\]</span></p>
<p>donde <span class="math inline">\(\lambda\)</span> es el parámetro de la distribución Poisson. Además, <span class="math inline">\(E[Y] = \text{Var}[Y] = \lambda\)</span>. Como se discutirá más adelante, esta es una propiedad fundamental de la distribución Poisson que tiene implicaciones importantes en el modelo de Regresión Poisson.</p>
<p>Con frecuencia, este parámetro se interpreta, por ejemplo, como (1) el número <em>esperado</em> de unidades defectuosas por hora; (2) el número <em>esperado</em> de defectos por metro cuadrado de baldosa producido; o (3) el número esperado de productos defectuosos por unidad de empaque. Formalmente, <span class="math inline">\(\lambda\)</span> puede verse como la <em>tasa</em> a la que ocurren los eventos de interés.</p>
<p>La función de masa de probabilidad de <span class="math inline">\(Y\)</span> está dada por:</p>
<p><span class="math display">\[
P(Y = y | \lambda) = \frac{e^{-\lambda}\lambda^y}{y!}, \quad y=0,1,\ldots
\]</span></p>
</div>
<div id="por-qué" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Por qué?</h3>
<p>El modelo de Regresión Poisson <strong>aparece</strong> como una alternativa para incluir información de los factores controlables del proceso en la estimación del parámetro <span class="math inline">\(\lambda\)</span> , a través de un predictor lineal. Posteriormente, al tener condiciones definidas de operación, es decir, valores específicos para las variables independientes, podremos calcular <span class="math inline">\(\lambda\)</span> como</p>
<p><span class="math display">\[\hat{\lambda} = f(x_1, x_2, \ldots, x_k).\]</span></p>
<p>Formalmente, esto es</p>
<p><span class="math display">\[
\log\left(\lambda\right) = \beta_0 + \beta_1x_1 + \beta_2x_2 + \cdots \beta_kx_k + \epsilon
\]</span>
donde <span class="math inline">\(\mathbf{\beta} = (\beta_0, \beta_1, \ldots, \beta_k)\)</span> son los coeficientes del modelo y <span class="math inline">\(\epsilon\)</span> es el error aleatorio.</p>
<p>A partir de esta expresión es fácil llegar a que</p>
<p><span class="math display">\[\begin{equation}
\hat\lambda = e^{\hat{\beta}_0 + \hat{\beta}_1x_1 + \hat{\beta}_2x_2 - \cdots +\hat{\beta}_kx_k}\cdot
\end{equation}\]</span></p>
<p>Así, <span class="math display">\[Y \sim \text{Poisson}(\hat{\lambda})\]</span></p>
<p>y</p>
<p><span class="math display">\[\begin{align}
P(Y = y | x_1, x_2, \ldots, x_k) &amp;= P(Y|\hat{\lambda}) \\             
                  &amp;= \frac{e^{-\hat{\lambda}}\hat{\lambda}^y}{y!}\cdot
\end{align}\]</span></p>
<p>Consideremos un proceso en el que se contabilizan el número de artículos defectuosos por cada unidad de empaque producida y supongamos que se controlan las variables <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span>.</p>
<p>Si definimos</p>
<p><span class="math display">\[Y = \text{Número de artículos defectuosos por unidad de empaque},\]</span>
entonces <span class="math inline">\(Y\sim\text{Poisson}(\lambda)\)</span>, <span class="math inline">\(\lambda&gt;0\)</span>.</p>
<p>A partir de una muestra de tamaño <span class="math inline">\(n\)</span>, es fácil llegar a que un estimador <em>insesgado</em> de <span class="math inline">\(\lambda\)</span> es</p>
<p><span class="math display">\[\hat{\lambda} = \frac{1}{n}\sum_{i=1}^n y_i.\]</span></p>
<p>Sin embargo, observe que al emplear este estimador de <span class="math inline">\(\lambda\)</span>, no tenemos en cuenta información adicional sobre dicho parámetro que las variables <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span> pudieran proporcionarnos.</p>
</div>
<div id="ejemplo" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Ejemplo</h3>
<p>Se tienen datos de un experimento en el que se empacaron 150 unidades de empaque de un producto particular. Cada unidad de empaque tiene 10 unidades de producto. Una vez empacadas, a cada empaque se le realizó inspección 100% y se registró el número de artículos defectuosos, además de las condiciones de operación de la máquina (variables <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span>) y el tipo de máquina (variable <span class="math inline">\(x_3\)</span>).</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="glm.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lectura de datos</span></span>
<span id="cb110-2"><a href="glm.html#cb110-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.dropbox.com/s/xpxy928ugcxr3ck/machine.txt?dl=1&quot;</span></span>
<span id="cb110-3"><a href="glm.html#cb110-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.table</span>(url, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-4"><a href="glm.html#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="glm.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># primeras 4 filas de los datos</span></span>
<span id="cb110-6"><a href="glm.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##            x1         x2 x3 y
## 1 -0.56047565  0.7877388 M2 0
## 2 -0.23017749  0.7690422 M1 0
## 3  1.55870831  0.3322026 M2 0
## 4  0.07050839 -1.0083766 M2 0</code></pre>
<p>La distribución del número de artículos defectuosos por unidad de empaque es:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="glm.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="do">## barplot</span></span>
<span id="cb112-2"><a href="glm.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb112-3"><a href="glm.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Freq &lt;- with(d, table(y))</span></span>
<span id="cb112-4"><a href="glm.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y))) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">&quot;midnightblue&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Número de artículos defectuosos&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="glm.html#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Frecuencia&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:barplot"></span>
<img src="book-adii_files/figure-html/barplot-1.png" alt="Número de artículos defectuosos por unidad de empaque en la muestra." width="432" />
<p class="caption">
Figura 4.1: Número de artículos defectuosos por unidad de empaque en la muestra.
</p>
</div>
<p>Puesto que trabajamos con conteos, una distribución de probabilidad posible que describe la variable <span class="math inline">\(Y\)</span> es <span class="math inline">\(Y\sim \text{Poisson}(\lambda)\)</span>, <span class="math inline">\(\lambda&gt;0\)</span>. A partir de la muestra, se obtiene que</p>
<p><span class="math display">\[\hat\lambda = \frac{1}{150}\sum_{i=1}^{150}y_i = 0.9\]</span></p>
<p>Sin embargo, observe que la estimación de <span class="math inline">\(\lambda\)</span> no tienen en cuenta las coordenadas <span class="math inline">\((x_1, x_2)\)</span> ni de la máquina en la que se empaca el producto, lo cual sería deseable.</p>
</div>
<div id="modelo-ajustado" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Modelo ajustado</h3>
<p>Puesto que las condiciones de operación y la máquina en la que se empaca el producto podrían ser determinantes en el número de artículos defectuosos por unidad de empaque que se obtienen, planteamos un modelo de Regresión Poisson. El modelo ajustado es:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="glm.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="do">## modelo de Regresión Poisson</span></span>
<span id="cb113-2"><a href="glm.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="do">## la funcion clave es glm --- para ayuda ver ?glm</span></span>
<span id="cb113-3"><a href="glm.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="do">## como la respuesta es binaria, debemos seleccionar family = poisson()</span></span>
<span id="cb113-4"><a href="glm.html#cb113-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> d, <span class="at">family =</span> <span class="fu">poisson</span>())</span>
<span id="cb113-5"><a href="glm.html#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="glm.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co"># coeficientes estimados</span></span>
<span id="cb113-7"><a href="glm.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit) </span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ ., family = poisson(), data = d)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4277  -0.7602  -0.3576   0.2688   2.1429  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -0.6283     0.1542  -4.074 4.62e-05 ***
## x1            0.9460     0.1037   9.125  &lt; 2e-16 ***
## x2           -1.3260     0.1425  -9.304  &lt; 2e-16 ***
## x3M2         -0.8869     0.1962  -4.521 6.15e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 348.68  on 149  degrees of freedom
## Residual deviance: 118.44  on 146  degrees of freedom
## AIC: 269.45
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Para determinar si el modelo ajustado es mejor que el modelo <code>y ~ 1</code>, usamos una prueba de razón de verosimilitud (LRT en inglés). Aunque esta prueba esta implementada en el paquete <code>base</code> de <code>R</code> a través de la función <code>anova</code>, el reporte de los resultados es más informativo cuando usamos la función <code>lrtest</code> del paquete <code>lmtest</code>:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="glm.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">## verificar disponibilidad de lmtest</span></span>
<span id="cb115-2"><a href="glm.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(lmtest)) <span class="fu">install.packages</span>(<span class="st">&quot;lmtest&quot;</span>)</span>
<span id="cb115-3"><a href="glm.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(lmtest)</span>
<span id="cb115-4"><a href="glm.html#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="glm.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="do">## comparación del modelos usando la LRT ajustamos un modelo simple</span></span>
<span id="cb115-6"><a href="glm.html#cb115-6" aria-hidden="true" tabindex="-1"></a>nullmodel <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> d, <span class="at">family =</span> <span class="fu">poisson</span>())</span>
<span id="cb115-7"><a href="glm.html#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="glm.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="do">## LRT</span></span>
<span id="cb115-9"><a href="glm.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(nullmodel, fit)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: y ~ 1
## Model 2: y ~ x1 + x2 + x3
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   1 -245.84                         
## 2   4 -130.73  3 230.24  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Conclusión.</strong> El modelo de Regresión Poisson que incluye las covariables <span class="math inline">\(x_1, x_2\)</span> y <span class="math inline">\(x_3\)</span> es significativamente mejor que un modelo sin ellas para explicar el número de artículos defectuosos por unidad de empaque.</p>
<p>Una forma de determinar que el modelo tiene <strong>buen ajuste</strong>, es a través de la utilización del <em>Deviance</em>. Para más detalles, ver la sección <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-poissonreg.html#sec-PoisGOF">4.4.9</a> del texto <em>Beyond Multiple Linear Regression</em>. La idea fundamental es consiste calcular el valor <span class="math inline">\(p\)</span> de la prueba de hipótesis</p>
<p><span class="math display">\[
\begin{align}
H_0&amp;: \text{El modelo propuesto tiene bien ajuste.} \\
H_1&amp;: \text{El modelo propuesto NO tiene bien ajuste.}
\end{align}
\]</span></p>
<p>En este caso, el valor <span class="math inline">\(p\)</span> de la prueba de hipótesis puede cacularse fácilmente como:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="glm.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">## deviance test</span></span>
<span id="cb117-2"><a href="glm.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(fit, <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(deviance, df.residual))</span></code></pre></div>
<pre><code>## [1] 0.9542188</code></pre>
<p>Como el valor <span class="math inline">\(p\)</span> es <span class="math inline">\(&gt;0.05\)</span>, decimos que el modelo <em>no</em> sufre de falta de ajuste. En otras palabras, que nuestro modelo ajusta bien los datos.</p>
<div id="sobredispersión" class="section level4 unnumbered">
<h4>Sobredispersión</h4>
<p>El modelo de Regresión Poisson puede sufrir de <a href="https://en.wikipedia.org/wiki/Overdispersion">sobredispersión</a>. Este concepto se refiere a que, en la distribución Poisson, <span class="math inline">\(\text{Var}[Y] &gt; E[Y]\)</span>, es decir, que el supuesto principal de la distribución no se cumple. En nuestro caso,</p>
<!-- \begin{align} -->
<!-- \hat\lambda&=0.9 \\ -->
<!-- \widehat{\text{Var}[Y]} &= s^2 =3.07  -->
<!-- \end{align} -->
<!-- Por lo tanto, $$\hat{\phi} = \frac{\widehat{\text{Var}[Y]}}{\widehat{E[Y]}} > 1,$$ -->
<!-- por lo que es posible que exista sobredispersión. -->
<p>Una posible solución a la violación de la propiedad fundamental de la distribución Poisson es ajustar un modelo de Regresión Poisson con función de enlace tipo <code>quasipoisson</code> y estimar el parámetro de sobredispersión <span class="math inline">\(\phi\)</span> haciendo:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="glm.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ajuste del modelo con enlace quasipoisson</span></span>
<span id="cb119-2"><a href="glm.html#cb119-2" aria-hidden="true" tabindex="-1"></a>fitq <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> d, <span class="at">family =</span> quasipoisson)</span>
<span id="cb119-3"><a href="glm.html#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="glm.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ahora estimamos la dispersión</span></span>
<span id="cb119-5"><a href="glm.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitq)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ ., family = quasipoisson, data = d)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4277  -0.7602  -0.3576   0.2688   2.1429  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.6283     0.1505  -4.173 5.13e-05 ***
## x1            0.9460     0.1012   9.348  &lt; 2e-16 ***
## x2           -1.3260     0.1391  -9.531  &lt; 2e-16 ***
## x3M2         -0.8869     0.1915  -4.631 7.97e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.9529908)
## 
##     Null deviance: 348.68  on 149  degrees of freedom
## Residual deviance: 118.44  on 146  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>A partir de estos rresultados, se llega a que <span class="math inline">\(\hat{\phi} = 0.953\)</span>, lo cual indica que los datos no están sobredispersos.</p>
<p>Para estar <em>completamente</em> seguros, podemos hacer una prueba formal del tipo</p>
<p><span class="math display">\[
\begin{align}
H_0: \phi = 1 \\
H_1: \phi &gt; 1
\end{align}
\]</span></p>
<p>En <code>R</code>, esta prueba está implementada en la función <code>dispersiontest</code> del paquete <code>AER</code>:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="glm.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">## disponibilidad del paquete AER</span></span>
<span id="cb121-2"><a href="glm.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(AER)) <span class="fu">install.packages</span>(<span class="st">&#39;AER&#39;</span>)</span>
<span id="cb121-3"><a href="glm.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(AER)</span>
<span id="cb121-4"><a href="glm.html#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="glm.html#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="do">## prueba para el coeficiente de dispersión</span></span>
<span id="cb121-6"><a href="glm.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersiontest</span>(fit, <span class="at">trafo =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  fit
## z = -0.90813, p-value = 0.8181
## alternative hypothesis: true alpha is greater than 0
## sample estimates:
##       alpha 
## -0.07419873</code></pre>
<p><strong>Conclusión:</strong> No hay evidencia de sobredispersión. Cuando hay sobredispersión, una alternativa al modelo de Regresión Poisson es una <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-poissonreg.html#negative-binomial-modeling">Regresión Binomial Negativa</a>. Este modelo puede ajustarse en <code>R</code> con la función `<code>glm.nb</code> del paquete <code>MASS</code>.</p>
</div>
<div id="exceso-de-ceros" class="section level4 unnumbered">
<h4>Exceso de ceros</h4>
<p>Los datos provenientes de procesos de conteo podrían sufrir de <a href="https://stats.idre.ucla.edu/stata/dae/zero-inflated-poisson-regression/">exceso de ceros</a>. Esto se refiere, fuundamentalmente, a que el número de ceros en los datos es mayor al que esperaríamos si estos siguieran, en realidad, una distribución Poisson.</p>
<p>Por ejemplo, si <span class="math inline">\(Y\sim \text{Poisson}(\lambda)\)</span> y tuviéramos una muestra de tamaño <span class="math inline">\(n\)</span>, el número esperado de ceros sería
<span class="math display">\[n_0 = n\,P(Y=0|\lambda) = n\,e^{-\lambda}\]</span>
Si en la muestra de tamaño <span class="math inline">\(n\)</span> observamos que el número de ceros es <span class="math inline">\(n^\prime&gt;&gt;&gt;n_0\)</span>, entonces los datos están <em>inflados</em> con ceros. Por lo tanto, un modelo del tipo <a href="https://stats.idre.ucla.edu/r/dae/zip/">Zero-inflated Poisson Regression</a> sería más apropiado.</p>
<p>En nuestro caso, el número de ceros en la muestra es</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="glm.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">## número de ceros</span></span>
<span id="cb123-2"><a href="glm.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d, <span class="fu">sum</span>(y <span class="sc">==</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 93</code></pre>
<p>Bajo el modelo Poisson, se esperan</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="glm.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## número esperado de ceros</span></span>
<span id="cb125-2"><a href="glm.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(d<span class="sc">$</span>y)<span class="sc">*</span><span class="fu">NROW</span>(d)</span></code></pre></div>
<pre><code>## [1] 135</code></pre>
<p>por lo que no existe un exceso de estos.</p>
</div>
</div>
<div id="cálculo-e-inferencia-para-hatlambda" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Cálculo e inferencia para <span class="math inline">\(\hat{\lambda}\)</span></h3>
<p>Recordemos <span class="math inline">\(\hat{\lambda}\)</span> es el número <em>esperado</em> de artículos defectuosos por unidad de empaque cuando se conocen las variables <span class="math inline">\(x_1,x_2\)</span> y <span class="math inline">\(x_3\)</span>. En otras palabras, <span class="math inline">\(\hat{\lambda} = f(x_1, x_2, x_3)\)</span>.</p>
<p>A partir del modelo ajustado, la <em>tasa</em> de artículos defectuosos por unidad de empaque puede obtenerse como:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="glm.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## cálculo de lambdahat</span></span>
<span id="cb127-2"><a href="glm.html#cb127-2" aria-hidden="true" tabindex="-1"></a>lambdahat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb127-3"><a href="glm.html#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="glm.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ahora incluyamos lambdahat para los 5 primeros individuos</span></span>
<span id="cb127-5"><a href="glm.html#cb127-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(d), d, lambdahat)</span>
<span id="cb127-6"><a href="glm.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##   id          x1         x2 x3 y  lambdahat
## 1  1 -0.56047565  0.7877388 M2 0 0.04550495
## 2  2 -0.23017749  0.7690422 M1 0 0.15478211
## 3  3  1.55870831  0.3322026 M2 0 0.61806211
## 4  4  0.07050839 -1.0083766 M2 0 0.89455575
## 5  5  0.12928774 -0.1194526 M2 0 0.29097707</code></pre>
<p>Si las condiciones fueran <span class="math inline">\((2, -1)\)</span> y <span class="math inline">\((-2, 4)\)</span>, y se usara la máquina es <code>M1</code>, la <em>tasa</em> de artículos defectuosos por unidad de empaque sería:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="glm.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># que pasa para las coordenadas (2, -1), (-2, 4) y máquina M1?</span></span>
<span id="cb129-2"><a href="glm.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, </span>
<span id="cb129-3"><a href="glm.html#cb129-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb129-4"><a href="glm.html#cb129-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb129-5"><a href="glm.html#cb129-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x3 =</span> <span class="st">&#39;M1&#39;</span>), </span>
<span id="cb129-6"><a href="glm.html#cb129-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&#39;response&#39;</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $fit
##            1            2 
## 1.332580e+01 3.999625e-04 
## 
## $se.fit
##            1            2 
## 2.7092492536 0.0002847542 
## 
## $residual.scale
## [1] 1</code></pre>
<p>Un intervalo de confianza del 95% para <span class="math inline">\(\lambda\)</span> cuando <span class="math inline">\(x_1=2\)</span>, <span class="math inline">\(x_2=-1\)</span>, y <span class="math inline">\(x3=\text{M1}\)</span> está dado por</p>
<p><span class="math display">\[
13.325 \pm 1.96\times2.709 = (8.015, 18.635) 
\]</span></p>
<p>Esto indica que si trabajamos con estas condiciones de operación, se <em>espera</em> que el número de artículos defectuosos por unidad de empaque en la población esté en el intervalo <span class="math inline">\((8.015, 18.635)\)</span> con una confianza del 95%.</p>
</div>
<div id="estimación-del-número-de-errores" class="section level3" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> Estimación del número de errores</h3>
<p>Para las condiciones <span class="math inline">\((2,-1)\)</span> se esperan obtener <span class="math inline">\(\hat\lambda = 13.325\)</span> artículos defectuosos por unidad de empaque. Utilizando <em>simulación</em>, es fácil determinar la distribución del número de artículos defectuosos que se obtendrían en 1000 unidades de empaque producidas bajo estas condiciones. A partir de estos resultados podemos entonces calcular un intervalo de confianza del 95% para <span class="math inline">\(Y_0\)</span>, no para <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="glm.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="do">## número de errores en 10 intentos para 1000 hombres</span></span>
<span id="cb131-2"><a href="glm.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="do">## cuando el punto se proyecta en (2, -1)</span></span>
<span id="cb131-3"><a href="glm.html#cb131-3" aria-hidden="true" tabindex="-1"></a>lambdahat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> </span>
<span id="cb131-4"><a href="glm.html#cb131-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="dv">2</span>, </span>
<span id="cb131-5"><a href="glm.html#cb131-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x2 =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb131-6"><a href="glm.html#cb131-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x3 =</span> <span class="st">&#39;M1&#39;</span>), </span>
<span id="cb131-7"><a href="glm.html#cb131-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb131-8"><a href="glm.html#cb131-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-9"><a href="glm.html#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="do">## semilla aleatoria</span></span>
<span id="cb131-10"><a href="glm.html#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb131-11"><a href="glm.html#cb131-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-12"><a href="glm.html#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="do">## número de unidades de empaque</span></span>
<span id="cb131-13"><a href="glm.html#cb131-13" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb131-14"><a href="glm.html#cb131-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-15"><a href="glm.html#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="do">## número de errores </span></span>
<span id="cb131-16"><a href="glm.html#cb131-16" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, lambdahat)</span>
<span id="cb131-17"><a href="glm.html#cb131-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-18"><a href="glm.html#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="do">## intervalo de confianza del 95%</span></span>
<span id="cb131-19"><a href="glm.html#cb131-19" aria-hidden="true" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(yhat, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code></pre></div>
<pre><code>##  2.5% 97.5% 
##     7    21</code></pre>
<p>Esto indica que, bajo estas condiciones, el número de artículos defectuosos <em>esperado</em> para la próxima unidad de empaque estará entre 7 y 21, con una confianza del 95%. Gráficamente tendríamos:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="glm.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## barplot para el número de errores en (2, -1, &#39;M1&#39;)</span></span>
<span id="cb133-2"><a href="glm.html#cb133-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(yhat)</span>
<span id="cb133-3"><a href="glm.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred, <span class="fu">aes</span>(<span class="at">x =</span> yhat)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">&quot;midnightblue&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Número de artículos defectuosos para (2, -1, &#39;M1&#39;)&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-4"><a href="glm.html#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Frecuencia&quot;</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> lambdahat,</span>
<span id="cb133-5"><a href="glm.html#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:barplotnumeroderrores"></span>
<img src="book-adii_files/figure-html/barplotnumeroderrores-1.png" alt="Número predicho de artículos defectuosos por unidad de empaque." width="480" />
<p class="caption">
Figura 4.2: Número predicho de artículos defectuosos por unidad de empaque.
</p>
</div>
</div>
<div id="cálculo-de-probabilidades" class="section level3" number="4.3.7">
<h3><span class="header-section-number">4.3.7</span> Cálculo de probabilidades</h3>
<p>A partir del modelo ajustado es posible calcular probabilidades teniendo en cuenta las coordenadas <span class="math inline">\((x_1, x_2)\)</span> y el sexo o variable <span class="math inline">\(x_3\)</span>. Por ejemplo la probabilidad de que una persona cometa <em>exactamente</em> 3 errores en función de <span class="math inline">\((x_1, x_2, x_3)\)</span> puede expresarse como:</p>
<p><span class="math display">\[P(Y = 3 | x_1, x_2, x_3) = \frac{e^{-\hat\lambda}{\hat\lambda}^3}{3!}\]</span></p>
<p>donde
<span class="math display">\[\hat\lambda = e^{-0.628  + 0.946x_1 - 1.326x_2   -0.887x_{3,\text{M2}}}\]</span></p>
<p>con <span class="math inline">\(x_{3,\text{M2}}\)</span> una variable indicadora.</p>
<p>Para el perfil <span class="math inline">\((2, -1, \texttt{M1})\)</span> se tiene que <span class="math inline">\(\hat\lambda = 13.325\)</span>. Así,</p>
<p><span class="math display">\[P(Y = 3 | 2, -1, \texttt{M1}) = \frac{e^{-13.325}{13.325}^3}{3!} \approx 0.\]</span></p>
</div>
<div id="variaciones" class="section level3" number="4.3.8">
<h3><span class="header-section-number">4.3.8</span> Variaciones</h3>
<p>El modelo de Regresión Poisson tiene algunas variaciones. Para mayor información, se sugiere consultar el paquete <code>pscl</code> <span class="citation">(<a href="#ref-pscl" role="doc-biblioref">Jackman 2020</a>)</span> y el documento <em>Regression Models for Count Data in R</em> <span class="citation">(<a href="#ref-count" role="doc-biblioref">Zeileis, Kleiber, and Jackman 2008</a>)</span>.</p>

</div>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-pscl" class="csl-entry">
Jackman, Simon. 2020. <em><span class="nocase">pscl</span>: Classes and Methods for <span>R</span> Developed in the Political Science Computational Laboratory</em>. Sydney, New South Wales, Australia: United States Studies Centre, University of Sydney. <a href="https://github.com/atahk/pscl/">https://github.com/atahk/pscl/</a>.
</div>
<div id="ref-count" class="csl-entry">
Zeileis, Achim, Christian Kleiber, and Simon Jackman. 2008. <span>“Regression Models for Count Data in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 27 (8): 1–25. <a href="http://www.jstatsoft.org/v27/i08/">http://www.jstatsoft.org/v27/i08/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rlm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jivelez/book-adii/edit/master/04-glm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jivelez/book-adii/blob/master/04-glm.Rmd",
"text": null
},
"download": ["book-adii.pdf", "book-adii.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
